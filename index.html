<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Deploy Ethereum-compatible contract on multiple chains with same address.">

    <title>Contract Deployer</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.0.32/dist/ethers.umd.min.js"></script>

    <style>
        .x-border {
            border: 1px solid #ced4da;
            border-left: 0.25rem solid #5bc0de;
            border-radius: 0.25rem;
            padding: 1rem;
        }

        .bg-gray:hover {
            background-color: #eee;
        }

        a {
            text-decoration: none;
        }

        textarea {
            resize: vertical;
            font-family: Monaco, 'Lucida Console', 'Courier New', Courier, monospace;
        }
    </style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-G71EH5JJVS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-G71EH5JJVS');
    </script>

    <script>
        window.CONTRACT_ADDR = '0xEa5837e1F89e3cf23027dA7866e6492458383B59';
        window.CONTRACT_ABI = '[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"creatorAddress","type":"address"},{"indexed":false,"internalType":"address","name":"contractAddress","type":"address"}],"name":"ContractDeployed","type":"event"},{"inputs":[{"internalType":"bytes32","name":"salt","type":"bytes32"},{"internalType":"bytes","name":"contractBytecode","type":"bytes"}],"name":"deployContract","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"salt","type":"bytes32"},{"internalType":"bytes","name":"contractBytecode","type":"bytes"},{"internalType":"bytes","name":"constructorArgsEncoded","type":"bytes"}],"name":"deployContractWithConstructor","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[],"name":"fee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_fee","type":"uint256"}],"name":"setFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_to","type":"address"}],"name":"setOwner","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address payable","name":"_to","type":"address"}],"name":"withdrawFee","outputs":[],"stateMutability":"nonpayable","type":"function"}]';
        window.CHAINS = {
            // chainId: ['name', 'https://scanurl', 'sortBy']
            '1': ['Ethereum', 'https://etherscan.io', 10],
            '56': ['BSC', 'https://bscscan.com', 20],
            '137': ['Polygon', 'https://polygonscan.com', 30],
            '250': ['Fantom', 'https://ftmscan.com', 40],
            '43114': ['Avalanche', 'https://snowtrace.io', 50],
            '42161': ['Arbitrum', 'https://arbiscan.io', 60],
            '128': ['Heco', 'https://hecoinfo.com', 70],
            '66': ['OKChain', 'https://www.oklink.com/okc', 80],
            // testnet:
            '5': ['Goerli Testnet', 'https://goerli.etherscan.io', 10010],
            '97': ['BSC Testnet', 'https://testnet.bscscan.com', 10020],
            '80001': ['Ploygon Testnet', 'https://mumbai.polygonscan.com', 10030],
            '4002': ['Fantom Testnet', 'https://testnet.ftmscan.com', 10040],
            '43113': ['Avalanche Testnet', 'https://testnet.snowtrace.io', 10050],
            '421613': ['Arbitrum Goerli Testnet', 'https://goerli.arbiscan.io', 10060]
        };

        $(function () {
            let chains = [];
            for (let chainId in window.CHAINS) {
                chains.push(window.CHAINS[chainId]);
            }
            chains.sort((c1, c2) => c1[2] - c2[2]);
            for (let i = 0; i < chains.length; i++) {
                let chain = chains[i];
                $('#chainList').append('<a target="_blank" href="' + chain[1] + '/address/' + window.CONTRACT_ADDR + '" class="me-4">' + chain[0] + ' <i class="bi bi-box-arrow-up-right"></i></a>');
            }
        });

        function splitHex(hexString) {
            if (hexString.startsWith('0x')) {
                hexString = hexString.substring(2);
            }
            let
                size = Math.ceil(hexString.length / 64),
                lines = Array(size),
                i;
            for (i = 0; i < size; i++) {
                lines[i] = hexString.substr(i * 64, 64);
            }
            return lines.join('\n');
        }

        function saltWorker(start, end, hexContractPrefix, hexContractBytecodeWithout0x, hexBytecodeHashWithout0x, fnCallback) {
            // calculate salt:
            let
                saltWithout0x, hexPayload, addr,
                prefix = '0xff' + window.CONTRACT_ADDR.toLowerCase().substring(2);
            for (i = start; i < end; i++) {
                saltWithout0x = i.toString(16).padStart(64, '0');
                hexPayload = prefix + saltWithout0x + hexBytecodeHashWithout0x;
                addr = ethers.utils.getAddress('0x' + ethers.utils.keccak256(hexPayload).substring(26));
                if (addr.startsWith(hexContractPrefix)) {
                    fnCallback('0x' + saltWithout0x, addr);
                    return;
                }
            }
            fnCallback(null, null);
        }

        function paddingHexString(s, len) {
            x = s;
            if (x.startsWith('0x')) {
                x = x.substring(2);
            }
            while (x.length < len) {
                x = '0' + x;
            }
            return '0x' + x;
        }

        function formatHexString(s, asBytes, minLength, maxLength) {
            s = s.replaceAll('\n', '').replaceAll('\r', '').replaceAll('\t', '').replaceAll(' ', '');
            if (!s.startsWith('0x')) {
                s = '0x' + s;
            }
            if (! /^0x[0-9a-fA-F]+$/.test(s)) {
                return null;
            }
            if (asBytes && s.length % 2 === 1) {
                return null;
            }
            let len = s.length - 2;
            if (len < minLength) {
                return null;
            }
            if (len > maxLength) {
                return null;
            }
            return s;
        }

        function formatArgValue(arg) {
            if (arg.type === 'string') {
                return arg.value;
            }
            let s = arg.value.trim();
            if (arg.type === 'address') {
                try {
                    return ethers.utils.getAddress(s).toLowerCase();
                } catch (err) {
                    console.error(err);
                    return null;
                }
            }
            if (arg.type === 'bool') {
                if (s === 'true') {
                    return true;
                }
                if (s === 'false') {
                    return false;
                }
                return null;
            }
            if (arg.type === 'bytes') {
                return formatHexString(s, true, arg.size * 2, arg.size * 2);
            }
            if (arg.type === 'uint') {
                return formatHexString(s, false, 1, arg.size >> 2);
            }
            return null;
        }

        function getWeb3Provider() {
            if (!window.web3Provider) {
                if (!window.ethereum) {
                    console.error("there is no web3 provider.");
                    return null;
                }
                window.web3Provider = new ethers.providers.Web3Provider(window.ethereum, "any");
            }
            return window.web3Provider;
        }

        function showAlert(title, message) {
            let m = $('#alertModal');
            m.find('.x-title').text(title);
            m.find('.x-message').text(message);
            let myModal = new bootstrap.Modal(m.get(0), { backdrop: 'static', keyboard: false });
            myModal.show();
        }

        function showInfo(title, message) {
            let m = $('#infoModal');
            m.find('.x-title').text(title);
            m.find('.x-message').text(message);
            let myModal = new bootstrap.Modal(m.get(0), { backdrop: 'static', keyboard: false });
            myModal.show();
        }

        function showLoading(title, message) {
            let m = $('#loadingModal');
            let myModal = new bootstrap.Modal(m.get(0), { backdrop: 'static', keyboard: false });
            let obj = {
                setTitle: (t) => {
                    m.find('.x-title').text(t);
                },
                setMessage: (t) => {
                    m.find('.x-message').text(t);
                },
                close: () => {
                    setTimeout(function () {
                        myModal.hide();
                    }, 500);
                }
            }
            obj.setTitle(title);
            obj.setMessage(message);
            myModal.show();
            return obj;
        }

        function translateError(err) {
            window.err = err;
            if (typeof (err) === 'string') {
                return err;
            }
            if (err.error && err.error.code && err.error.message) {
                return `Error (${err.error.code}): ${err.error.message}`;
            }
            if (err.code && err.message) {
                return `Error (${err.code}): ${err.message}`;
            }
            return err.message || err.toString();
        }

        function createArg(type, size) {
            if (size === undefined) {
                size = '';
            }
            let arg = {
                type: type,
                size: size,
                sizeList: [''],
                value: '',
                error: ''
            };
            if (type === 'uint') {
                arg.sizeList = ['', 8, 16, 24, 32, 48, 64, 96, 128, 160, 192, 224, 256];
            } else if (type === 'bytes') {
                arg.sizeList = ['', 1, 2, 3, 4, 5, 6, 7, 8, 12, 16, 24, 32];
            }
            return arg;
        }

        function getArgType(arg) {
            if (arg.size === '' || arg.size === '0') {
                return arg.type;
            }
            return arg.type + arg.size;
        }

        function init() {
            console.log('init vue...');
            window.vm = new Vue({
                el: '#vm',
                data: {
                    account: null,
                    chainId: 0,
                    // data for deploying:
                    contractBytecode: '',
                    constructorByteCode: '',
                    calculatePrefix: 'true',
                    contractPrefix: '0xCafe',
                    salt: '0x00',
                    deployingAddress: '',
                    accept: false,
                    args: []
                },
                computed: {
                    ready: function () {
                        return this.account && this.chainId > 0;
                    },
                    networkName: function () {
                        if (this.account) {
                            let cs = window.CHAINS[this.chainId];
                            if (cs) {
                                return cs[0];
                            }
                            return 'Unsupported Chain (0x' + this.chainId.toString(16) + ')';
                        }
                        return 'Not connected';
                    },
                    wrongNetwork: function () {
                        return this.account && !window.CHAINS[this.chainId];
                    }
                },
                methods: {
                    addArg: function () {
                        this.args.push(createArg('address'));
                    },
                    removeArg: function (index) {
                        this.args.splice(index, 1);
                    },
                    hex2decimal: function (str) {
                        str = str.trim();
                        if (str.startsWith('0x')) {
                            str = str.substring(2);
                        }
                        try {
                            let n = parseInt(str, 16);
                            if (!isNaN(n)) {
                                return '0x' + n.toString(16) + ' = ' + n + ' (decimal)';
                            }
                        } catch (e) {
                            return '';
                        }
                    },
                    isArgSizeListDisabled: function (arg) {
                        return arg.type !== 'uint' && arg.type !== 'bytes';
                    },
                    getArgSizeList: function (arg) {
                        if (arg.type === 'uint') {
                            return [8, 16, 24, 32, 48, 64, 96, 128, 160, 192, 224, 256];
                        } else if (arg.type === 'bytes') {
                            return [1, 2, 3, 4, 5, 6, 7, 8, 12, 16, 24, 32];
                        } return ['N/A'];
                    },
                    getPlaceholder: function (arg) {
                        if (arg.type === 'address') {
                            return '0xA1b2...';
                        }
                        if (arg.type === 'bool') {
                            return 'true or false';
                        }
                        if (arg.type === 'string') {
                            return 'UTF-8 string';
                        }
                        if (arg.type === 'uint') {
                            return '0x00';
                        }
                        if (arg.type === 'bytes') {
                            return '0x00';
                        }
                    },
                    abbrAddress: function (addr) {
                        if (!addr) {
                            return '';
                        }
                        let s = addr.toString();
                        if (s.indexOf('0x') === 0 && s.length === 42) {
                            let addr = ethers.utils.getAddress(s.substring(0));
                            return addr.substring(0, 6) + '...' + addr.substring(38);
                        }
                        return s;
                    },
                    gotoScanUrl: function () {
                        let cs = window.CHAINS[this.chainId];
                        if (cs) {
                            window.open(cs[1] + '/address/' + this.account);
                        } else {
                            console.error('Invalid chain id: ', this.chainId);
                        }
                    },
                    deploy: async function () {
                        try {
                            if (!this.ready) {
                                throw 'Wallet not ready!';
                            }
                            if (!window.CHAINS[this.chainId]) {
                                throw 'Unsupported chain!';
                            }
                            let
                                i, arg, argTypes = [], argType, argValue, argValues = [], abiEncoder, hexArgs = '0x',
                                hexContractBytecode = formatHexString(this.contractBytecode, true, 100, 49152),
                                boolCalculatePrefix = this.calculatePrefix === 'true',
                                hexContractPrefix = formatHexString(this.contractPrefix, false, 1, 10),
                                hexSalt = formatHexString(this.salt, false, 1, 64),
                                argsLength = this.args.length;
                            // check bytecode:
                            if (hexContractBytecode === null) {
                                throw 'Invalid contract bytecode!';
                            }
                            // check prefix:
                            if (boolCalculatePrefix) {
                                if (hexContractPrefix === null) {
                                    throw new 'Invalid address prefix!';
                                }
                            } else {
                                // check salt:
                                if (hexSalt === null) {
                                    throw new 'Invalid salt!';
                                } else {
                                    hexSalt = paddingHexString(hexSalt, 64);
                                }
                            }
                            // check each argument:
                            if (argsLength > 0) {
                                for (i = 0; i < argsLength; i++) {
                                    arg = this.args[i];
                                    argType = getArgType(arg);
                                    argValue = formatArgValue(arg);
                                    console.log('check arg ' + (i + 1) + ': ' + argType + ' = ' + argValue);
                                    if (argValue === null) {
                                        throw 'Invalid argument ' + (i + 1) + '!';
                                    }
                                    argTypes.push(argType);
                                    argValues.push(argValue);
                                }
                                console.log(argTypes);
                                console.log(argValues);
                                abiEncoder = new ethers.utils.AbiCoder();
                                hexArgs = abiEncoder.encode(argTypes, argValues);
                                console.log('Argument encoding:\n' + hexArgs);
                            }

                            // calculate salt:
                            if (boolCalculatePrefix) {
                                let loading = showLoading('Deploy Contract', 'Prepare for deploying contract...');
                                loading.setMessage('Searching salt... 0.000%');
                                let
                                    saltWithout0x, hexPayload, addr, start, end,
                                    range = 484,
                                    hexBytecodeHashWithout0x = ethers.utils.keccak256(hexContractBytecode + hexArgs.substring(2)).substring(2),
                                    hexContractBytecodeWithout0x = hexContractBytecode.substring(2);

                                window.deploySalt = {
                                    cancel: false,
                                    start: 0,
                                    end: range,
                                    total: Math.pow(22, hexContractPrefix.length - 1)
                                };
                                window.deploySaltFn = function () {
                                    saltWorker(window.deploySalt.start, window.deploySalt.end, hexContractPrefix, hexContractBytecodeWithout0x, hexBytecodeHashWithout0x, (theSalt, theAddress) => {
                                        console.log('searched ' + window.deploySalt.start);
                                        if (theSalt === null) {
                                            if (window.deploySalt.cancel) {
                                                console.log('cancelled.');
                                            } else {
                                                loading.setMessage('Searching salt... ' + (window.deploySalt.start * 100 / window.deploySalt.total).toFixed(3) + '%');
                                                window.deploySalt.start += range;
                                                window.deploySalt.end += range;
                                                setTimeout(window.deploySaltFn, 0);
                                            }
                                        } else {
                                            console.log('found salt: ' + theSalt, theAddress);
                                            loading.close();
                                            console.log(argTypes);
                                            window.vm.doDeploy(argTypes, argValues, hexContractBytecode, hexArgs, theSalt, theAddress);
                                        }
                                    });
                                };
                                setTimeout(window.deploySaltFn, 1000);
                            } else {
                                let
                                    hexBytecodeHashWithout0x = ethers.utils.keccak256(hexContractBytecode + hexArgs.substring(2)).substring(2),
                                    hexPayload = '0xff' + window.CONTRACT_ADDR.toLowerCase().substring(2) + hexSalt.substring(2) + hexBytecodeHashWithout0x,
                                    targetAddress = ethers.utils.getAddress('0x' + ethers.utils.keccak256(hexPayload).substring(26));
                                this.doDeploy(argTypes, argValues, hexContractBytecode, hexArgs, hexSalt, targetAddress);
                            }
                        } catch (e) {
                            showAlert('Error', translateError(e));
                        }
                    },
                    doDeploy: function (argTypes, argValues, hexBytecode, hexConstructor, hexSalt, expectedAddress) {
                        let
                            i,
                            deployInfo = 'https://deploy.eth.itranswarp.com\n\n',
                            argLength = argTypes.length;
                        deployInfo = deployInfo + '[contract-address]\n' + expectedAddress + '\n\n';
                        deployInfo = deployInfo + '[salt]\n' + hexSalt + '\n\n';
                        if (argLength > 0) {
                            for (i = 0; i < argLength; i++) {
                                deployInfo = deployInfo + '[argument-' + (i + 1) + ']\n' + argTypes[i] + ' = ' + argValues[i] + '\n\n'
                            }
                            deployInfo = deployInfo + '[constructor]\n' + splitHex(hexConstructor) + '\n\n';
                        }
                        deployInfo = deployInfo + '[bytecode]\n' + splitHex(hexBytecode) + '\n';
                        let
                            $m = $('#deployModal'),
                            $a = $m.find('a.x-download'),
                            $btn = $m.find('#deployButton'),
                            blob = new Blob([deployInfo], { type: 'text/plain' });
                        $m.find('textarea').val(deployInfo);
                        $a.get(0).href = window.URL.createObjectURL(blob);
                        $a.get(0).download = 'deploy-' + expectedAddress + '.txt';
                        $m.get(0).addEventListener('hidden.bs.modal', function (event) {
                            $btn.off('click');
                        });
                        $btn.on('click', function () {
                            myModal.hide();
                            let fn = async function () {
                                let theContract = new ethers.Contract(window.CONTRACT_ADDR, window.CONTRACT_ABI, window.getWeb3Provider().getSigner());
                                let tx;
                                if (argLength === 0) {
                                    tx = await theContract.deployContract(hexSalt, hexBytecode);
                                } else {
                                    tx = await theContract.deployContractWithConstructor(hexSalt, hexBytecode, hexConstructor);
                                };
                                await tx.wait(1);
                            };
                            let loading = showLoading('Deploy Contract', 'Please sign the transaction in MetaMask and wait for blockchain confirmation...');
                            fn().then(() => {
                                loading.close();
                                showInfo('Deployed', 'Contract ' + expectedAddress + ' was deployed successfully!');
                            }).catch((e) => {
                                loading.close();
                                showAlert('Error', translateError(e));
                            });
                        });
                        let myModal = new bootstrap.Modal($m.get(0), { backdrop: 'static', keyboard: false });
                        myModal.show();
                    },
                    accountChanged: function (accounts) {
                        console.log('wallet account changed:', accounts.length === 0 ? null : accounts[0]);
                        if (accounts.length === 0) {
                            this.disconnected();
                        } else {
                            this.account = accounts[0];
                            document.cookie = '__account__=' + this.account + ';max-age=1296000';
                        }
                    },
                    disconnected: async function () {
                        console.warn('wallet disconnected.');
                        this.account = null;
                    },
                    chainChanged: function (chainId) {
                        console.log('wallet chainId changed: ' + chainId + ' = ' + parseInt(chainId, 16));
                        this.chainId = parseInt(chainId, 16);
                    },
                    connectWallet: async function () {
                        console.log('try connect wallet...');
                        if (window.getWeb3Provider() === null) {
                            console.error('there is no web3 provider.');
                            return false;
                        }
                        try {
                            this.accountChanged(await window.ethereum.request({
                                method: 'eth_requestAccounts',
                            }));
                            this.chainChanged(await window.ethereum.request({
                                method: 'eth_chainId'
                            }));
                            window.ethereum.on('disconnect', this.disconnected);
                            window.ethereum.on('accountsChanged', this.accountChanged);
                            window.ethereum.on('chainChanged', this.chainChanged);
                        } catch (e) {
                            console.error('could not get a wallet connection.', e);
                            return false;
                        }
                        console.log('wallet connected.');
                        return true;
                    }
                }
            });
        }

        $(function () {
            init();
        });
    </script>
</head>

<body>
    <!-- Loading Modal -->
    <div id="loadingModal" class="modal fade" role="dialog" aria-hidden="true" aria-labelledby="loadingLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header align-items-center d-flex">
                    <h4 class="modal-title x-title" id="loadingLabel">&nbsp;</h4>
                </div>
                <div class="modal-body">
                    <div class="float-start">
                        <div class="spinner-border" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                    </div>
                    <div class="ms-5 ps-4 float-none">
                        <p class="x-message">&nbsp;</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button onclick="window.deploySalt.cancel = true;" class="btn btn-outline-primary"
                        data-bs-dismiss="modal" aria-label="Close">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Alert Modal -->
    <div id="alertModal" class="modal fade" role="dialog" aria-hidden="true" aria-labelledby="alertLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header align-items-center d-flex">
                    <h4 class="modal-title x-title" id="alertLabel">&nbsp;</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fe fe-x-circle"></i></span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="float-start">
                        <i class="fs-2 text-danger fe fe-alert-triangle"></i>
                    </div>
                    <div class="ms-5 ps-4 float-none">
                        <p class="x-message">&nbsp;</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-primary" data-bs-dismiss="modal" aria-label="Close">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div id="infoModal" class="modal fade" role="dialog" aria-hidden="true" aria-labelledby="infoLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header align-items-center d-flex">
                    <h4 class="modal-title x-title" id="infoLabel">&nbsp;</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fe fe-x-circle"></i></span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="float-start">
                        <i class="fs-2 fe fe-info"></i>
                    </div>
                    <div class="ms-5 ps-4 float-none">
                        <p class="x-message">&nbsp;</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline-primary" data-bs-dismiss="modal" aria-label="Close">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Deploy Modal -->
    <div id="deployModal" class="modal fade" role="dialog" aria-hidden="true" aria-labelledby="deployLabel">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header align-items-center d-flex">
                    <h4 class="modal-title x-title" id="deployLabel">Deploy Contract</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true"><i class="fe fe-x-circle"></i></span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>The contract deployment is ready:</p>
                    <form>
                        <div class="mb-3">
                            <textarea id="deployInfo" readonly rows="6" class="form-control form-control-sm"></textarea>
                        </div>
                        <div class="mb-3">
                            <p>IMPORTANT: please <a href="#0" class="x-download">download</a> the deployment information
                                for future
                                deploy.</p>
                        </div>
                        <div class="mb-3">
                            <p>Please click "Deploy" button to deploy after download.</p>
                        </div>
                    </form>

                </div>
                <div class="modal-footer">
                    <button id="deployButton" class="btn btn-outline-primary">Deploy</button>
                </div>
            </div>
        </div>
    </div>

    <div id="vm" class="container">
        <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom"
            style="position:fixed; top:0; left:0; right:0; z-index: 99;">
            <div class="container">
                <a class="navbar-brand" href="#0"><i class="bi bi-gear-wide-connected"></i> Contract Deployer</a>
                <ul id="wallet" class="mr-2 navbar-nav navbar-right-wrap" style="flex-direction: row !important;">
                    <li class="nav-item">
                        <span class="nav-link"><i class="bi bi-globe"></i>
                            <span v-text="networkName"></span></span>
                    </li>
                    <li v-if="account===null" class="nav-item">
                        <button v-on:click="connectWallet" type="button" class="btn btn-primary">Connect Wallet</button>
                    </li>
                    <li v-if="account!==null" class="nav-item">
                        <a href="#0" class="nav-link" v-on:click="gotoScanUrl"><i class="bi bi-wallet"></i>
                            <span v-text="abbrAddress(account)"></span> <i class="fe fe-external-link"></i></a>
                    </li>
                    <li v-if="wrongNetwork" class="ms-2 d-inline-block">
                        <span class="nav-link">Unsupported chain (<span v-text="chainId"></span>)</span>
                    </li>
                </ul>
            </div>
        </nav>

        <div style="padding-top: 70px;">
            <div class="row">
                <div class="col">
                    <div class="x-border">
                        <h5>Contract Deploy</h5>
                        <p>This is an online tool for deploying EVM-compatible contracts on multiple chains with same
                            address. Supported chains:</p>
                        <p id="chainList"></p>
                        <p>Please read the <a target="_blank"
                                href="https://github.com/michaelliao/contract-deployer/blob/master/doc.md">document
                                <i class="bi bi-box-arrow-up-right"></i></a>
                            to learn how to deploy contract.</p>
                        <p>Make sure you have tested on testnet before deploy to the mainnet.</p>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <form action="#0" onsubmit="return false">
                        <div class="mt-4">
                            <h5>Contract Bytecode</h5>
                        </div>
                        <div class="p-3">
                            <label for="byteCode" class="form-label">Contract bytecode (hex string only):</label>
                            <textarea v-model="contractBytecode" id="byteCode" placeholder="0x6080..." rows="10"
                                class="form-control form-control-sm"></textarea>
                            <div class="form-text">Paste the contract bytecode as hex string. Allow multiple lines.
                            </div>
                        </div>
                        <div class="mt-4">
                            <h5>Contract Address</h5>
                        </div>
                        <div class="me-4 p-3">
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input v-model="calculatePrefix" class="form-check-input" type="radio" value="true">
                                    Calculate contract address with prefix (case sensitive):
                                </label>
                            </div>
                            <input v-model="contractPrefix" v-bind:disabled="calculatePrefix!=='true'" maxlength="10"
                                placeholder="0xCafe" class="ms-4 form-control form-control-sm ">
                        </div>
                        <div class="me-4 p-3">
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input v-model="calculatePrefix" class="form-check-input" type="radio"
                                        value="false">
                                    Specify salt (uint256 as hex number):
                                </label>
                            </div>
                            <input v-model="salt" v-bind:disabled="calculatePrefix!=='false'" length="66"
                                placeholder="0x00" class="ms-4 form-control form-control-sm ">
                        </div>
                        <div class="mt-4">
                            <h5>Constructor Arguments</h5>
                        </div>
                        <div v-for="(arg, index) in args" class="p-3 rounded bg-gray">
                            <div class="row">
                                <div class="col-6 col-sm-5 col-md-4 col-lg-3 col-xl-3 col-xxl-2">
                                    <label for="salt" class="form-label">Argument <span v-text="index+1"></span>:
                                    </label>
                                </div>
                                <div class="col-6 col-sm-7 col-md-8 col-lg-9 col-xl-9 col-xxl-10">
                                    <label v-if="arg.type==='uint'" v-text="hex2decimal(arg.value)"
                                        class="form-label"></label>
                                    <a v-on:click="removeArg(index)" href="#0" class="d-block float-end">Remove</a>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6 col-sm-5 col-md-4 col-lg-3 col-xl-3 col-xxl-2">
                                    <select v-model="arg.type" class="form-select form-select-sm"
                                        style="display:inline-block; width:100px">
                                        <option value="address">address</option>
                                        <option value="bool">bool</option>
                                        <option value="string">string</option>
                                        <option value="uint">uint</option>
                                        <option value="bytes">bytes</option>
                                    </select>
                                    <select v-model="arg.size" v-bind:disabled="isArgSizeListDisabled(arg)"
                                        class="form-select form-select-sm" style="display:inline-block; width:75px">
                                        <option v-for="s in getArgSizeList(arg)" v-text="s"></option>
                                    </select>
                                </div>
                                <div class="col-6 col-sm-7 col-md-8 col-lg-9 col-xl-9 col-xxl-10">
                                    <input v-model="arg.value" v-bind:placeholder="getPlaceholder(arg)"
                                        class="form-control form-control-sm">
                                </div>
                            </div>
                        </div>
                        <div class="p-3">
                            <button v-on:click="addArg" type="button"
                                class="btn btn-outline-primary form-control-sm">Add Argument</button>
                        </div>
                        <div class="mt-3 mb-3">
                            <div class="form-check">
                                <label class="form-check-label">
                                    <input v-model="accept" class="form-check-input" type="checkbox" value="true">
                                    I AGREE THAT THERE IS NO WARRANTY FOR THE PROGRAM. THE ENTIRE RISK AS TO THE QUALITY
                                    AND PERFORMANCE OF THE PROGRAM IS WITH YOU.
                                </label>
                            </div>
                        </div>
                        <div class="mb-3">
                            <button v-on:click="deploy" v-bind:disabled="!accept" type="submit"
                                class="btn btn-primary btn-lg">Check &amp;
                                Deploy</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <footer class="p-5 mt-5 bg-light border-top">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="mb-4"><i class="bi bi-gear-wide-connected"></i> Contract Deployer, copyleft 2022</div>
                    <ul class="list-unstyled small text-muted">
                        <li class="mb-2">Designed and built by
                            <a target="_blank" href="https://github.com/michaelliao">Michael Liao
                                <i class="bi bi-box-arrow-up-right"></i></a>.
                        </li>
                        <li class="mb-2">Fork me on
                            <a target="_blank" href="https://github.com/michaelliao/contract-deployer">Github
                                <i class="bi bi-box-arrow-up-right"></i></a>
                        </li>
                        <li class="mb-2">Code licensed
                            <a target="_blank"
                                href="https://github.com/michaelliao/contract-deployer/blob/master/LICENSE">GPLv3
                                <i class="bi bi-box-arrow-up-right"></i></a>
                        </li>
                        <li class="mb-2">Check
                            <a target="_blank"
                                href="https://github.com/michaelliao/contract-deployer/blob/master/contract.sol">contract
                                source code
                                <i class="bi bi-box-arrow-up-right"></i></a>.
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </footer>
</body>

</html>
